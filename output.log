INFO:matplotlib.font_manager:generated new fontManager
WARNING:ray.worker:File descriptor limit 1024 is too low for production servers and may result in connection errors. At least 8192 is recommended. --- Fix with 'ulimit -n 8192'
2022-12-07 13:40:38,338	INFO services.py:778 -- Starting process with command: ['/lib/python3.8/site-packages/ray/core/src/ray/gcs/gcs_server', '--log_dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/logs', '--config_list=eyJvYmplY3Rfc3BpbGxpbmdfY29uZmlnIjogIntcInR5cGVcIjogXCJmaWxlc3lzdGVtXCIsIFwicGFyYW1zXCI6IHtcImRpcmVjdG9yeV9wYXRoXCI6IFwiL2hvc3QvdG1wL3JheS9zZXNzaW9uXzIwMjItMTItMDdfMTMtNDAtMzhfMzI0OTY0XzJcIn19IiwgImlzX2V4dGVybmFsX3N0b3JhZ2VfdHlwZV9mcyI6IHRydWV9', '--gcs_server_port=49539', '--metrics-agent-port=57851', '--node-ip-address=172.17.0.2', '--redis_password=5241590000000000']
/lib/python3.8/site-packages/ray/thirdparty_files/psutil/_pslinux.py:513: RuntimeWarning: buffers, cached, shared, active, inactive memory stats couldn't be determined and were set to 0
  warnings.warn(msg, RuntimeWarning)
system_memory: 6442450944
avail_memory: 4321660928
redis_max_memory: None
object_store_memory: 524288000
memory: 3365206836
shm_avail: 0
2022-12-07 13:40:39,471	WARNING services.py:2003 -- WARNING: The object store is using /tmp instead of /dev/shm because /dev/shm has only 0 bytes available. This will harm performance! You may be able to free up space by deleting files in /dev/shm. If you are inside a Docker container, you can increase /dev/shm size by passing '--shm-size=0.54gb' to 'docker run' (or add it to the run_options list in a Ray cluster config). Make sure to set this to more than 30% of available RAM.
calling start_raylet
2022-12-07 13:40:39,514	INFO services.py:778 -- Starting process with command: ['/lib/python3.8/site-packages/ray/core/src/ray/raylet/raylet', '--raylet_socket_name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/raylet', '--store_socket_name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/plasma_store', '--object_manager_port=0', '--min_worker_port=0', '--max_worker_port=0', '--node_manager_port=0', '--node_ip_address=172.17.0.2', '--maximum_startup_concurrency=8', '--static_resource_list=node:172.17.0.2,1.0,CPU,8,memory,3365206836,object_store_memory,524288000', '--python_worker_command=/bin/python3.8 /lib/python3.8/site-packages/ray/workers/setup_worker.py /lib/python3.8/site-packages/ray/workers/default_worker.py --node-ip-address=172.17.0.2 --node-manager-port=RAY_NODE_MANAGER_PORT_PLACEHOLDER --object-store-name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/plasma_store --raylet-name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/raylet --redis-address=None --storage=None --temp-dir=/host/tmp/ray --metrics-agent-port=57851 --logging-rotate-bytes=536870912 --logging-rotate-backup-count=5 --gcs-address=172.17.0.2:49539 RAY_WORKER_DYNAMIC_OPTION_PLACEHOLDER --redis-password=5241590000000000', '--java_worker_command=', '--cpp_worker_command=', '--native_library_path=/lib/python3.8/site-packages/ray/cpp/lib', '--redis_password=5241590000000000', '--temp_dir=/host/tmp/ray', '--session_dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2', '--log_dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/logs', '--resource_dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/runtime_resources', '--metrics-agent-port=57851', '--metrics_export_port=39691', '--object_store_memory=524288000', '--plasma_directory=/tmp', '--ray-debugger-external=0', '--gcs-address=172.17.0.2:49539', '--agent_command=/bin/python3.8 -u /lib/python3.8/site-packages/ray/dashboard/agent.py --node-ip-address=172.17.0.2 --metrics-export-port=39691 --dashboard-agent-port=57851 --listen-port=0 --node-manager-port=RAY_NODE_MANAGER_PORT_PLACEHOLDER --object-store-name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/plasma_store --raylet-name=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/sockets/raylet --temp-dir=/host/tmp/ray --session-dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2 --runtime-env-dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/runtime_resources --log-dir=/host/tmp/ray/session_2022-12-07_13-40-38_324964_2/logs --logging-rotate-bytes=536870912 --logging-rotate-backup-count=5 --gcs-address=172.17.0.2:49539 --minimal']
end calling start_raylet, next is to wait_for_node
start_ray_processes end
_initialize_global_state start
_initialize_global_state end
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 0
clients: 1
wait_for_node end
get_node_to_connect_for_driver end
Create node end
_initialize_internal_kv end
_initialize_global_state end
Create CoreWorker...
[2022-12-07 13:40:44,092 I 2 2] logging.cc:194: Set ray log level from environment variable RAY_BACKEND_LOG_LEVEL to -1
Create CoreWorker end
notify_raylet end
[torch-ray] Start to init `Trainer`
2022-12-07 13:40:44,301	INFO trainer.py:248 -- Trainer logs will be logged in: /root/ray_results/train_2022-12-07_13-40-44
2022-12-07 13:40:44,301	INFO trainer.py:204 -- num_cpus: 1, num_gpus: 0
2022-12-07 13:40:44,301	INFO trainer.py:213 -- Start to create `BackendExecutor` ActorClass
2022-12-07 13:40:44,303	INFO trainer.py:215 -- Created `BackendExecutor` ActorClass: <ray.train.backend.ActorClass(BackendExecutor) object at 0x7fdaafde4c10>
2022-12-07 13:40:44,303	INFO trainer.py:217 -- Start to init `BackendExecutor` Actor.
2022-12-07 13:40:44,321	INFO trainer.py:229 -- Done init `BackendExecutor` Actor: {backend_executor_actor}.
[torch-ray] Done init `Trainer`, prepare to start
^C